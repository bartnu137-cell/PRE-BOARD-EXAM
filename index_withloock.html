<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EE Pre-Board Exam</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --grid-line: rgba(0, 243, 255, 0.1);
            --bg-dark: #020c1b;
            --surface: #0a192f;
            --text-main: #ccd6f6;
            --gold: #ffd700;
            --correct: #238636;
            --wrong: #da3633;
            --locked-gray: #4a5568;
            --danger: #ff4444;
        }

        body {
            margin: 0;
            background-color: var(--bg-dark);
            /* Engineering Grid Pattern Background */
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 40px 40px;
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 750px;
            padding: 30px;
            text-align: center;
            animation: fadeIn 0.5s ease;
            max-height: 90vh;
            overflow-y: auto;
            background: rgba(10, 25, 47, 0.95);
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.15);
            backdrop-filter: blur(5px);
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        #welcome-screen { display: flex; }
        
        .title-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            color: var(--neon-blue);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
            margin-bottom: 10px;
        }

        .motto {
            font-style: italic;
            color: var(--gold);
            letter-spacing: 2px;
            margin-bottom: 40px;
            font-size: 1.2rem;
            border-top: 1px solid var(--grid-line);
            border-bottom: 1px solid var(--grid-line);
            padding: 10px 0;
            width: 80%;
        }

        input {
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            font-size: 1.5rem;
            text-align: center;
            padding: 10px;
            width: 80%;
            margin: 30px 0;
            outline: none;
            font-family: 'Orbitron';
        }

        .btn {
            background: transparent;
            color: var(--neon-blue);
            border: 2px solid var(--neon-blue);
            padding: 15px 50px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 3px;
            transition: 0.3s;
            font-family: 'Orbitron';
            margin: 10px;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.1);
        }

        .btn:hover { 
            background: var(--neon-blue); 
            color: var(--bg-dark); 
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.6); 
        }

        .subject-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
            margin-top: 20px;
        }

        .subject-card {
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid var(--neon-blue);
            padding: 25px;
            cursor: pointer;
            transition: 0.3s;
            font-family: 'Orbitron';
            color: var(--neon-blue);
            position: relative;
        }

        .subject-card:not(.locked):hover { 
            background: var(--neon-blue); 
            color: var(--bg-dark); 
            transform: translateY(-5px);
            box-shadow: 0 0 15px var(--neon-blue);
        }

        .subject-card.locked {
            border-color: var(--locked-gray);
            color: var(--locked-gray);
            background: rgba(0, 0, 0, 0.3);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .subject-card.locked::after {
            content: "ðŸ”’";
            display: block;
            margin-top: 10px;
            font-size: 1.2rem;
            filter: grayscale(100%);
        }

        .option {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #30363d;
            cursor: pointer;
            text-align: left;
            transition: 0.2s;
        }

        .option:hover { border-color: var(--neon-blue); }
        .option.selected { border: 2px solid var(--neon-blue); background: rgba(0, 243, 255, 0.1); }
        .option.correct { background: var(--correct) !important; color: white; border-color: var(--correct); }
        .option.wrong { background: var(--wrong) !important; color: white; border-color: var(--wrong); }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 20px;
            font-family: 'Orbitron', sans-serif;
            border-bottom: 1px solid var(--neon-blue);
            padding-bottom: 15px;
        }

        .stat-item span { color: var(--gold); font-size: 1.2rem; margin-left: 10px; }
        
        /* Specific style for timer */
        #timer-text { color: var(--danger); text-shadow: 0 0 5px var(--danger); }

        #solution-container {
            display: none;
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--gold);
            padding: 20px;
            margin-top: 20px;
            text-align: left;
            width: 100%;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>

    <div id="welcome-screen" class="screen">
        <h1 class="title-text">WELCOME FUTURE<br>ELECTRICAL ENGINEER!</h1>
        <div class="motto">"<u>Colossians 3:23</u>"<br><strong>Whatever you do, work at it with all your heart,<br>as working for the Lord</strong></div>
        <p style="margin-top: 30px; color: #8892b0;">SYSTEM READY // INITIALIZING DATABASE...</p>
        <button class="btn" onclick="showScreen('name-screen')">INITIALIZE</button>
    </div>

    <div id="name-screen" class="screen">
        <h2 style="font-family: 'Orbitron'; color: var(--gold);">IDENTIFICATION REQUIRED</h2>
        <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
            <span style="font-size: 1.5rem; color: var(--neon-blue);">ENGR.</span>
            <input type="text" id="userName" placeholder="ENTER SURNAME" autocomplete="off">
        </div>
        <button class="btn" onclick="saveName()">ACCESS MODULES</button>
    </div>

    <div id="subject-screen" class="screen">
        <h2 id="greeting-text" style="color: var(--gold); font-family: 'Orbitron';"></h2>
        <p style="letter-spacing: 2px;">SELECT EXAMINATION MODULE:</p>
        <div class="subject-grid">
            <div class="subject-card" onclick="startExam('Mathematics')">MATHEMATICS <br><span style="color: white; font-size: 0.8rem; font-family: 'Rajdhani', sans-serif; letter-spacing: 1px; font-weight: normal;">(Pre-Board Exam 50 Items)</span></div>
            <div class="subject-card locked" onclick="moduleLocked()">AC MACHINES</div>
            <div class="subject-card locked" onclick="moduleLocked()">POWER SYSTEMS</div>
            <div class="subject-card locked" onclick="moduleLocked()">LAWS & ETHICS</div>
        </div>
    </div>

    <div id="exam-screen" class="screen">
        <h3 id="current-subject" style="color: var(--neon-blue); margin-bottom: 5px; font-family: 'Orbitron';"></h3>
        
        <div class="stats-bar">
            <div class="stat-item">Q: <span id="progress-text">1 / 50</span></div>
            <div class="stat-item">TIME: <span id="timer-text">00:00</span></div>
            <div class="stat-item">SCORE: <span id="live-score">0</span></div>
        </div>

        <h2 id="question-text" style="font-weight: 300; margin: 20px 0;"></h2>
        <div id="options-container" style="width: 100%;"></div>
        
        <div id="solution-container">
            <h4 style="color: var(--gold); margin: 0 0 10px 0;">SOLUTION:</h4>
            <p id="solution-text" style="color: #fff;"></p>
            <h4 style="color: var(--gold); margin: 15px 0 10px 0;">CALCULATOR (Canon F-789SGA):</h4>
            <p id="calc-technique" style="color: var(--neon-blue); font-family: monospace;"></p>
        </div>

        <button id="action-btn" class="btn" style="margin-top: 30px;" onclick="handleAction()">COMMIT ANSWER</button>
    </div>

    <div id="result-screen" class="screen">
        <h1 id="final-status" style="color: var(--gold); font-family: 'Orbitron';"></h1>
        <p id="score-text" style="font-size: 1.5rem; margin: 30px 0;"></p>
        <button class="btn" onclick="location.reload()">RETURN TO MAINFRAME</button>
    </div>

<script>
    let userName = "";
    let selectedSubject = "";
    let currentIdx = 0;
    let score = 0;
    let selectedAnswer = null;
    let showingSolution = false;
    let shuffledQuestions = []; 
    let timerInterval = null;
    const EXAM_DURATION = 14400; // 4 Hours in seconds
    let timeRemaining = EXAM_DURATION; 
    
    // --- AUTHORIZED SURNAMES (UPPERCASE for strict matching) ---
    const AUTHORIZED_PERSONNEL = [
        "FELIZARTA", 
        "RAMOS", 
        "SALIGAO", 
        "FERNANDEZ", 
        "CORTEZ", 
        "MACEDA", 
        "QUILLOPO", 
        "ARCENAS"
    ];

    const database = {
    "Mathematics": [
            { 
                q: "In an examination, an examinee may select 7 problems from a set of 10 questions. In how many ways can he make his choice?", 
                a: ["604,800 ways", "100 ways", "120 ways", "150 ways"], 
                c: "120 ways",
                showSolution: "Combination problem (order doesn't matter). nCr = 10C7. 10! / (7!3!) = 120.",
                calculatorTechnique: "Press [1][0] [SHIFT][Ã·](nCr) [7] [=]."
            },
            { 
                q: "The quadratic equation whose roots are 2 and -3 is:", 
                a: ["xÂ²-x-6=0", "xÂ²-x+6=0", "xÂ²+x-6=0", "xÂ²+x+6=0"], 
                c: "xÂ²+x-6=0",
                showSolution: "Use reverse factoring: (x - r1)(x - r2) = 0. (x - 2)(x - (-3)) = (x-2)(x+3) = xÂ² + 3x - 2x - 6 = xÂ² + x - 6.",
                calculatorTechnique: "Mode 5 (EQN) > 3. Test options. For xÂ²+x-6, inputs: 1, 1, -6. Roots = 2, -3."
            },
            { 
                q: "The fourth term in the binomial expansion of (3s+2t)âµ is:", 
                a: ["24st", "720sÂ²tÂ³", "648sâ´t", "24sâ´t"], 
                c: "720sÂ²tÂ³",
                showSolution: "Term formula: nCr * (a)^(n-r) * (b)^r where r is term number - 1. For 4th term, r=3. 5C3 * (3s)Â² * (2t)Â³ = 10 * 9sÂ² * 8tÂ³ = 720sÂ²tÂ³.",
                calculatorTechnique: "Calculate coeff: 5C3 * 3^2 * 2^3."
            },
            { 
                q: "Mario can finish a job two hours longer than Pepe. After working for 1 hour, Pepe joins him and they can complete the job in 3 more hours. How long would it take Mario to finish the job alone?", 
                a: ["5 hr", "6 hr", "8 hr", "10 hr"], 
                c: "10 hr",
                showSolution: "Let P = Pepe's time, M = Pepe + 2. Mario works 4hrs total, Pepe works 3hrs. 4/M + 3/P = 1. Sub M=P+2: 4/(P+2) + 3/P = 1. Solve for P=8, so M=10.",
                calculatorTechnique: "Use Shift-Solve: 4/(X) + 3/(X-2) = 1 (solving for Mario directly) or test choices."
            },
            { 
                q: "Determine the area enclosed by the circle xÂ²+yÂ²-10x+4y=196.", 
                a: ["15Ï€", "225Ï€", "12Ï€", "144Ï€"], 
                c: "225Ï€",
                showSolution: "Standard form: (xÂ²-10x+25) + (yÂ²+4y+4) = 196+25+4. (x-5)Â²+(y+2)Â² = 225. rÂ²=225. Area=Ï€rÂ²=225Ï€.",
                calculatorTechnique: "Add constants to RHS: 196 + (10/2)Â² + (4/2)Â² = 225. Area = 225Ï€."
            },
            { 
                q: "A river flows at 3 mph. Find the speed of a motorboat which goes upstream 2 miles at the same time required to go 3 miles downstream.", 
                a: ["10 mph", "15 mph", "20 mph", "25 mph"], 
                c: "15 mph",
                showSolution: "Time = Dist/Speed. T_up = T_down. 2/(v-3) = 3/(v+3). 2v+6 = 3v-9. v=15.",
                calculatorTechnique: "Input 2/(X-3) = 3/(X+3), Shift-Solve."
            },
            { 
                q: "What is the volume of a right circular cylinder inscribed in a cube of edge 10 cm?", 
                a: ["200Ï€ cmÂ³", "230Ï€ cmÂ³", "250Ï€ cmÂ³", "300Ï€ cmÂ³"], 
                c: "250Ï€ cmÂ³",
                showSolution: "Cube edge = 10. Cylinder diameter = 10 (r=5), height = 10. V = Ï€rÂ²h = Ï€(5)Â²(10) = 250Ï€.",
                calculatorTechnique: "Calc: Ï€ * 5Â² * 10."
            },
            { 
                q: "In how many ways can 5 people line up to pay their electric bills if two particular persons refuse to follow each other?", 
                a: ["120", "90", "72", "140"], 
                c: "72",
                showSolution: "Total ways - Ways together. 5! - (4! * 2!) = 120 - 48 = 72.",
                calculatorTechnique: "5! - (4! * 2!)."
            },
            { 
                q: "The length of the latus rectum of parabola with yÂ²-8x-4y-20=0 is:", 
                a: ["2", "4", "6", "8"], 
                c: "8",
                showSolution: "Group y's: (yÂ²-4y) = 8x+20. Complete square: (y-2)Â² = 8x+24 = 8(x+3). 4a = 8. Latus Rectum = 4a = 8.",
                calculatorTechnique: "Look at the coefficient of the non-squared variable (x). It is 8."
            },
            { 
                q: "Given a triangle with angle C=28.7Â°, side a=132 units and side b=224 units. Solve for angle B.", 
                a: ["130Â°", "110Â°", "120Â°", "90Â°"], 
                c: "130Â°",
                showSolution: "Sine Law requires a pair. Use Cosine Law for c first: cÂ²=aÂ²+bÂ²-2abCosC. Then SinB/b = SinC/c. Note: Case of ambiguity, B is obtuse.",
                calculatorTechnique: "Use Pol/Rec or Cosine Law program. Solve for c, then use Sine Law."
            },
            { 
                q: "If tan 4A = cot 6A, then what is the value of angle A?", 
                a: ["9Â°", "12Â°", "10Â°", "14Â°"], 
                c: "9Â°",
                showSolution: "Cofunction identity: tan(x) = cot(90-x). 4A = 90-6A. 10A = 90. A=9.",
                calculatorTechnique: "Shift-Solve: tan(4X) = 1/tan(6X)."
            },
            { 
                q: "How many dozens of tiles measuring 5 cm by 5 cm are needed to cover a wall measuring 2 m by 1.5 m?", 
                a: ["100", "120", "1,000", "1,200"], 
                c: "100",
                showSolution: "Wall Area = 200cm * 150cm = 30,000cmÂ². Tile Area = 25cmÂ². Num Tiles = 30000/25 = 1200. Dozens = 1200/12 = 100.",
                calculatorTechnique: "(200*150) / (5*5) / 12."
            },
            { 
                q: "Find the first derivative of ln(cos x).", 
                a: ["csc x", "-tan x", "sec x", "cot x"], 
                c: "-tan x",
                showSolution: "Chain rule: d/dx(ln u) = u'/u. u=cos x, u'=-sin x. (-sin x)/(cos x) = -tan x.",
                calculatorTechnique: "d/dx function: d/dx(ln(cos(X))) at X=0.5. Compare result with -tan(0.5)."
            },
            { 
                q: "A man 1.8 m tall is walking at the rate of 1.2 m/s away from a lamp post 6.7 m high. At what rate is the tip of his shadow receding from the lamp post?", 
                a: ["2.16 m/s", "1.64 m/s", "1.83 m/s", "1.78 m/s"], 
                c: "1.64 m/s",
                showSolution: "Similar triangles: Let x be distance of man from post, y be distance of tip from post. y/6.7 = (y-x)/1.8. Differentiate wrt t. dy/dt = (6.7)/(6.7-1.8) * dx/dt.",
                calculatorTechnique: "Rate of tip = (H / (H-h)) * rate_man = (6.7 / (6.7-1.8)) * 1.2."
            },
            { 
                q: "Solve the double integral: âˆ«(0 to Ï€/2) âˆ«(2 to 4cosÎ¸) ÏÂ³ dÏ dÎ¸", 
                a: ["Ï€/3", "10Ï€", "Ï€/2", "3Ï€"], 
                c: "3Ï€",
                showSolution: "Inner integral: [Ïâ´/4] from 2 to 4cosÎ¸ = 1/4(256cosâ´Î¸ - 16). Outer integral of that from 0 to Ï€/2. Result is 3Ï€.",
                calculatorTechnique: "Directly input the definite integral if calculator supports double integrals (rare), or do inner step manually then integrate 64cosâ´x - 4 from 0 to Ï€/2."
            },
            { 
                q: "What theorem is used to solve for centroids?", 
                a: ["Pappus'", "Varignon's", "Castiglliano's", "Pascal's"], 
                c: "Varignon's",
                showSolution: "Varignon's Theorem (principle of moments) states that the moment of a resultant force is equal to the sum of the moments of its components. Used for centroids (moment of area).",
                calculatorTechnique: "Concept only."
            },
            { 
                q: "Find two numbers whose sum are 20 and whose product is maximum.", 
                a: ["8 and 12", "10 and 10", "6 and 14", "9 and 11"], 
                c: "10 and 10",
                showSolution: "x + y = 20 -> y = 20-x. P = x(20-x) = 20x - xÂ². dP/dx = 20 - 2x = 0 -> x=10.",
                calculatorTechnique: "For max product of a constant sum, the numbers must be equal."
            },
            { 
                q: "A conical vessel 12 cm deep and with a radius of 6 cm at the top, is being filled with water. If the rate at which the water rises is 2 cm/s, how fast is the volume increasing when the water is 4 cm deep?", 
                a: ["3Ï€", "4Ï€", "8Ï€", "16Ï€"], 
                c: "8Ï€",
                showSolution: "r/h = 6/12 = 1/2, so r = h/2. V = 1/3Ï€(h/2)Â²h = Ï€hÂ³/12. dV/dt = (3Ï€hÂ²/12) dh/dt = (Ï€hÂ²/4) dh/dt. At h=4: Ï€(16)/4 * 2 = 8Ï€.",
                calculatorTechnique: "Derivative at a point."
            },
            { 
                q: "iÂ¹â°â° is equal to:", 
                a: ["i", "-i", "1", "-1"], 
                c: "1",
                showSolution: "Powers of i cycle: i, -1, -i, 1. 100 is divisible by 4, so iÂ¹â°â° = (iâ´)Â²âµ = 1Â²âµ = 1.",
                calculatorTechnique: "Mode 2 (CMPLX). Calculate i^100 (might overflow on some). Trick: 100/4 has no remainder, so answer is 1."
            },
            { 
                q: "The inverse Laplace transform of 6/(2s+10) is:", 
                a: ["3eâ»Â¹â°áµ—", "6eâ»âµáµ—", "3eâ»âµáµ—", "0.6eâ»Â²áµ—"], 
                c: "3eâ»âµáµ—",
                showSolution: "Factor denominator: 6 / 2(s+5) = 3 / (s+5). Inverse Laplace of a/(s+b) is ae^(-bt). Result: 3e^(-5t).",
                calculatorTechnique: "N/A (Analytical)."
            },
            { 
                q: "Subtract (5-2i) from (3-5i).", 
                a: ["2+3i", "2-7i", "-2-3i", "4-2i"], 
                c: "-2-3i",
                showSolution: "(3-5i) - (5-2i) = 3-5 -5i+2i = -2 -3i.",
                calculatorTechnique: "Mode 2. (3-5i) - (5-2i)."
            },
            { 
                q: "Evaluate the determinant: |(3+4i) -2i; -2i (3-4i)|", 
                a: ["21", "5-16i", "29", "13-16i"], 
                c: "29",
                showSolution: "Det = (ad - bc). (3+4i)(3-4i) - (-2i)(-2i). (9 - 16iÂ²) - (4iÂ²) = (9+16) - (-4) = 25 + 4 = 29.",
                calculatorTechnique: "Mode 2. (3+4i)(3-4i) - (-2i)(-2i). Calc gives 29."
            },
            { 
                q: "An equilateral triangle has an altitude of 5âˆš3 cm long. Find its area.", 
                a: ["5âˆš3/4", "100âˆš3", "25âˆš3", "50âˆš3"], 
                c: "25âˆš3 cmÂ²",
                showSolution: "h = sâˆš3/2. 5âˆš3 = sâˆš3/2 -> s=10. Area = sÂ²âˆš3/4 = 100âˆš3/4 = 25âˆš3.",
                calculatorTechnique: "N/A"
            },
            { 
                q: "Find the total distance, in inches, which the tip of a pendulum will travel if the first swing is 10 inches, and each succeeding swing is 9/10 of the previous one.", 
                a: ["110", "99", "90", "100"], 
                c: "100",
                showSolution: "Infinite Geometric Series. S = a1 / (1-r). a1=10, r=0.9. S = 10 / (1-0.9) = 10/0.1 = 100.",
                calculatorTechnique: "10 Ã· (1 - 0.9)."
            },
            { 
                q: "The operator j when multiplied to a given vector will cause that vector to rotate counter-clockwise through an angle of,", 
                a: ["180Â°", "90Â°", "60Â°", "270Â°"], 
                c: "90Â°",
                showSolution: "Multiplication by complex number i (or j) corresponds to a 90 degree rotation in the Argand plane.",
                calculatorTechnique: "Arg(i) = 90."
            },
            { 
                q: "The Laplace transform of t eÂ²áµ— is,", 
                a: ["1/(s-2)Â²", "eÂ²/sÂ²", "1/sÂ²(s-2)", "eÂ²/(s-2)"], 
                c: "1/(s-2)Â²",
                showSolution: "L{t} = 1/sÂ². Shifting property L{e^at f(t)} = F(s-a). Here a=2. So 1/(s-2)Â².",
                calculatorTechnique: "N/A"
            },
            { 
                q: "Solve the equation: y dy - 4x dx = 0", 
                a: ["yÂ²+xÂ²=c", "4xÂ²-yÂ²=c", "yÂ²+4xÂ²=c", "yÂ²=4xÂ²+c"], 
                c: "yÂ²=4xÂ²+c",
                showSolution: "Integrate both sides: âˆ«y dy - âˆ«4x dx = 0. yÂ²/2 - 2xÂ² = C. Multiply by 2: yÂ² - 4xÂ² = k. Or yÂ² = 4xÂ² + k.",
                calculatorTechnique: "N/A"
            },
            { 
                q: "If the ratio of sec A to csc A is 1:4, find the ratio of tan A to cot A.", 
                a: ["4:1", "1:8", "8:1", "1:16"], 
                c: "1:16",
                showSolution: "secA/cscA = (1/cos)/(1/sin) = sin/cos = tanA = 1/4. Ratio asked: tanA/cotA = tanA / (1/tanA) = tanÂ²A = (1/4)Â² = 1/16.",
                calculatorTechnique: "tanA = 1/4. Calculate (1/4) / (4) = 1/16."
            },
            { 
                q: "If the half-life of a radioactive substance is 1500 years, determine the percentage that remains after 250 years.", 
                a: ["80%", "75%", "89%", "98%"], 
                c: "89%",
                showSolution: "Q = Qo(1/2)^(t/H). Q/Qo = (0.5)^(250/1500) = (0.5)^(1/6) â‰ˆ 0.8908.",
                calculatorTechnique: "0.5^(250/1500)."
            },
            { 
                q: "Find the value of a in the equation logâ‚ 2187 = 7/2.", 
                a: ["3", "6", "9", "12"], 
                c: "9",
                showSolution: "Definition of log: a^(7/2) = 2187. a = 2187^(2/7). 2187 is 3^7. (3^7)^(2/7) = 3^2 = 9.",
                calculatorTechnique: "Input 2187^(2/7)."
            },
            { 
                q: "Which of the following differential equations is a variable separable?", 
                a: ["2ydx=(xÂ²+1)dy", "(x+y)dx-2ydy=0", "(x+xÂ²y)dy=(2x+xyÂ²)dx", "yÂ²dx+(2x-3y)dy=0"], 
                c: "2ydx=(xÂ²+1)dy",
                showSolution: "Option A can be rewritten as 2y/(dy) = (xÂ²+1)/dx ... wait, 2y dy = (xÂ²+1) dx / (wrong algebra). Correct: 2y/(dy) no... 2y dx = (x^2+1) dy -> 2y dy / (something)? No. Separate: dx/(x^2+1) = dy/2y. Yes, it separates completely.",
                calculatorTechnique: "Look for equations where x and y can be isolated on opposite sides of the equals sign with their respective differentials."
            },
            { 
                q: "The rate of population growth of a country is proportional to the number of inhabitants. If the population of that country now is 40 million and 50 million in ten years, what will be its population (in million) 20 years from now?", 
                a: ["56.19", "71.29", "62.18", "59.24"], 
                c: "62.18",
                showSolution: "P = Po e^(kt). 50 = 40 e^(10k) -> e^(10k) = 1.25. For 20 years: P = 40 e^(20k) = 40 (e^10k)Â² = 40(1.25)Â² = 62.5. Closest choice is 62.18 (likely used rounded k).",
                calculatorTechnique: "Growth formula. 40 * (50/40)^(20/10) = 62.5. Note: Choices might use specific log rounding."
            },
            { 
                q: "A bag contains 3 white and 5 black balls. If two balls are drawn in succession without replacement, what is the probability that both balls are black?", 
                a: ["5/16", "5/28", "5/14", "5/32"], 
                c: "5/14",
                showSolution: "P(1st Black) = 5/8. P(2nd Black | 1st) = 4/7. Total P = 5/8 * 4/7 = 20/56 = 5/14.",
                calculatorTechnique: "5/8 * 4/7."
            },
            { 
                q: "Solve for x in the equation: Arctan (x+1) + Arctan (x-1) = Arctan 12", 
                a: ["1.5", "1.33", "1.20", "1.25"], 
                c: "1.33",
                showSolution: "tan(A+B) = (x+1 + x-1) / (1 - (x+1)(x-1)) = 2x / (1 - (xÂ²-1)) = 2x / (2-xÂ²). So 2x/(2-xÂ²) = 12. 2x = 24 - 12xÂ². 12xÂ² + 2x - 24 = 0. 6xÂ² + x - 12 = 0. Factors (3x - 4)(2x + 3). x = 4/3 = 1.33.",
                calculatorTechnique: "Shift-Solve: tanâ»Â¹(X+1) + tanâ»Â¹(X-1) = tanâ»Â¹(12)."
            },
            { 
                q: "A line from a point A to B has a bearing of N 55Â°W and a length of 50 m. Another line from A to C has a bearing of N 50Â°E and a length of 100 m. Find the length of the line BC.", 
                a: ["111.94 m", "133.74 m", "147.65 m", "122.83 m"], 
                c: "122.83 m",
                showSolution: "Angle BAC = 55Â° + 50Â° = 105Â°. Cosine Law: BCÂ² = 50Â² + 100Â² - 2(50)(100)cos(105). BC â‰ˆ 122.83.",
                calculatorTechnique: "Cosine Law input."
            },
            { 
                q: "How many dozens of tiles measuring 5 cm by 5 cm are needed to cover a wall measuring 2 m by 1.5 m?", 
                a: ["100", "120", "1,000", "1,200"], 
                c: "100",
                showSolution: "Wall Area = 200cm * 150cm = 30,000cmÂ². Tile Area = 25cmÂ². Num Tiles = 30000/25 = 1200. Dozens = 1200/12 = 100.",
                calculatorTechnique: "(200*150) / (5*5) / 12."
            },
            { 
                q: "Find the area bounded by the parabola yÂ²=4x and the line y=2x-4.", 
                a: ["7", "8", "9", "10"], 
                c: "9",
                showSolution: "Find intersections: (2x-4)Â² = 4x. 4xÂ²-16x+16 = 4x. xÂ²-5x+4=0. x=1,4. Integral (upper - lower) dx. âˆ«[âˆš4x - (2x-4)] is tricky. Better horizontal strip âˆ«(Right - Left) dy. Line x = (y+4)/2, Parabola x = yÂ²/4. Limits: Intersection y= -2 to 4. âˆ«[(y+4)/2 - yÂ²/4] dy from -2 to 4 = 9.",
                calculatorTechnique: "Integral of ((Y+4)/2 - YÂ²/4) from -2 to 4."
            },
            { 
                q: "Find x so that 5x-3, x+2 and 3x-11 will form an arithmetic progression.", 
                a: ["1", "2", "3", "4"], 
                c: "3",
                showSolution: "Common difference: (x+2) - (5x-3) = (3x-11) - (x+2). -4x+5 = 2x-13. 18 = 6x. x=3.",
                calculatorTechnique: "Shift-Solve: (X+2)-(5X-3) = (3X-11)-(X+2)."
            },
            { 
                q: "The vectors A = -4i + 2k and B = 2i - k are", 
                a: ["orthogonal", "parallel", "neither", "none of these"], 
                c: "parallel",
                showSolution: "Check ratio: -4/2 = -2. 2/-1 = -2. Since components are proportional, they are parallel.",
                calculatorTechnique: "Vector Mode. Calculate A x B. If 0, parallel."
            },
            { 
                q: "Five different mathematics books, four different physics books and 2 different books in electric circuits are to be placed on a shelf with the books of the same subject together. Find the number of ways in which the books can be placed.", 
                a: ["292", "5760", "12870", "34,560"], 
                c: "34,560",
                showSolution: "Arrangement of groups: 3! (M, P, C). Arrangement within groups: 5! * 4! * 2!. Total = 3! * 5! * 4! * 2! = 6 * 120 * 24 * 2 = 34,560.",
                calculatorTechnique: "3! * 5! * 4! * 2!."
            },
            { 
                q: "A closed cylindrical tank has a capacity of 576.56 mÂ³. Find the minimum surface area of the tank.", 
                a: ["383.40 mÂ²", "412.6 mÂ²", "516.32 mÂ²", "218.60 mÂ²"], 
                c: "383.40 mÂ²",
                showSolution: "For min surface area of closed cylinder with fixed volume, Diameter = Height (D=H) or r = h/2. V = Ï€rÂ²(2r) = 2Ï€rÂ³. 576.56 = 2Ï€rÂ³. r â‰ˆ 4.5. SA = 2Ï€rÂ² + 2Ï€rh = 2Ï€rÂ² + 4Ï€rÂ² = 6Ï€rÂ². SA = 6Ï€(4.5)Â² â‰ˆ 381... wait. D=H condition. V=Ï€DÂ³/4. D = cube_root(4V/Ï€) = 9. SA = 2(Ï€DÂ²/4) + Ï€D(D) = 1.5Ï€DÂ². 1.5Ï€(9)Â² â‰ˆ 381.7. Let's recheck Calc.",
                calculatorTechnique: "Optimization. For cylinder V=fixed, min Area is when h=2r. Calc r = Â³âˆš(V/2Ï€). Area = 6Ï€rÂ²."
            },
            { 
                q: "A conical vessel has a height of 24 cm. and a base diameter of 12 cm. It holds water to a depth of 18 cm. above its vertex. Find the volume of its content in cmÂ³", 
                a: ["381.70", "298.40", "412.60", "188.40"], 
                c: "381.70",
                showSolution: "Ratio: r/h = 6/24 = 1/4. Water r = 18/4 = 4.5. V = 1/3 Ï€ (4.5)Â² (18) = 381.70.",
                calculatorTechnique: "1/3 * Ï€ * 4.5Â² * 18."
            },
            { 
                q: "Express 2 sinÂ²Î¸ as a function of cos 2Î¸.", 
                a: ["cos 2Î¸-1", "cos 2Î¸+1", "1-cos 2Î¸", "1+cos 2Î¸"], 
                c: "1-cos 2Î¸",
                showSolution: "Identity: cos 2Î¸ = 1 - 2sinÂ²Î¸. Therefore, 2sinÂ²Î¸ = 1 - cos 2Î¸.",
                calculatorTechnique: "Test with Î¸=30. 2sinÂ²(30)=0.5. 1-cos(60)=0.5."
            },
            { 
                q: "Five different mathematics books, four different physics books and 2 different books in electric circuits are to be placed on a shelf with the books of the same subject together. Find the number of ways in which the books can be placed.", 
                a: ["292", "5760", "12870", "34,560"], 
                c: "34,560",
                showSolution: "Arrangement of groups: 3! (M, P, C). Arrangement within groups: 5! * 4! * 2!. Total = 3! * 5! * 4! * 2! = 6 * 120 * 24 * 2 = 34,560.",
                calculatorTechnique: "3! * 5! * 4! * 2!."
            },
            { 
                q: "The equation y = 3xÂ² + ceâ»Â²Ë£ is the general solution of,", 
                a: ["y'+2y=6xÂ²+6x", "y''+2y=6xÂ²+6x", "y'-2y=6x-6", "y''+2y=6x-6"], 
                c: "y'+2y=6xÂ²+6x",
                showSolution: "y = 3xÂ² + ceâ»Â²Ë£. y' = 6x - 2ceâ»Â²Ë£. Test A: (6x - 2ceâ»Â²Ë£) + 2(3xÂ² + ceâ»Â²Ë£) = 6x + 6xÂ². Matches RHS.",
                calculatorTechnique: "Differentiate y and substitute into options."
            },
            { 
                q: "If the domain of f(x) = (4x+3)/(x-1) is R-{1}, what is the range of f?", 
                a: ["R-{1}", "R-{2}", "R-{3}", "R-{4}"], 
                c: "R-{4}",
                showSolution: "Inverse function method. y = (4x+3)/(x-1). yx - y = 4x + 3. x(y-4) = y+3. x = (y+3)/(y-4). Denominator y-4 means y â‰  4.",
                calculatorTechnique: "Horizontal asymptote limit as x->inf is 4/1 = 4."
            },
            { 
                q: "Which of the following inequalities have a solution set (-2, 3)?", 
                a: ["xÂ²-8x-25â‰¥0", "xÂ²-4x-21â‰¥0", "xÂ²-4x-21<0", "xÂ²-x-6<0"], 
                c: "xÂ²-x-6<0",
                showSolution: "Roots -2 and 3 come from factors (x+2)(x-3) = xÂ²-x-6. For 'between' roots, we need < 0.",
                calculatorTechnique: "Mode 5 (Ineq). Test options."
            },
            { 
                q: "What is z when x=4 and y=2 if z varies directly as x and inversely as y, and if z=5 when x=2 and y=3?", 
                a: ["7.5", "15", "30", "10"], 
                c: "15",
                showSolution: "z = kx/y. 5 = k(2)/3 -> k = 7.5. New z = 7.5(4)/2 = 15.",
                calculatorTechnique: "Ratio method: z1*y1/x1 = z2*y2/x2."
            },
            { 
                q: "Find the 5th term of (3x-y)â¸.", 
                a: ["-5670xâ´yâ´", "5670xâ´yâ´", "13608xÂ³yâµ", "-13608xÂ³yâµ"], 
                c: "5670xâ´yâ´",
                showSolution: "8C4 (3x)â´ (-y)â´. 70 * 81xâ´ * yâ´ = 5670xâ´yâ´.",
                calculatorTechnique: "8C4 * 3^4 * (-1)^4."
            },
            { 
                q: "Find the value of x if the following forms a harmonic sequence; -1/2, 1, 1/x, 1/16.", 
                a: ["7", "8", "9", "10"], 
                c: "7",
                showSolution: "Reciprocals form Arithmetic Progression: -2, 1, x, 16. The differences must form a pattern or be constant. 1-(-2)=3. If diff is 3, next is 4 (so x=4), next 7. Doesn't match 16. However, looking at differences of options... if x=7, reciprocals are -2, 1, 7, 16. Differences: 3, 6, 9. These differences are in AP. This is a common exam pattern.",
                calculatorTechnique: "Mode 3 (Stat) > 2 (A+BX). X: 1, 2, 7 (positions). Y: -2, 1, 16. Check if r=1. -2, 1 (diff 3). 1+3=4, 4+3=7. So 7 is the 4th term. x=7."
            }
        ],
        "AC Machines": [
            { q: "The synchronous speed of a 4-pole motor at 60Hz is:", a: ["1200 rpm", "1800 rpm", "3600 rpm", "1500 rpm"], c: "1800 rpm", showSolution: "Ns = 120f/P = 1800.", calculatorTechnique: "120*60/4" }
        ]
    };

    // --- UTILITIES ---
    function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
        document.getElementById(screenId).style.display = 'flex';
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // --- CORE LOGIC ---
    function saveName() {
        const inputRaw = document.getElementById('userName').value;
        const inputName = inputRaw.trim().toUpperCase();

        if (!inputName) return alert("IDENTIFICATION REQUIRED");

        if (AUTHORIZED_PERSONNEL.includes(inputName)) {
            userName = inputName;
            document.getElementById('greeting-text').innerText = `WELCOME, ENGR. ${userName.toUpperCase()}`;
            showScreen('subject-screen');
        } else {
            alert("ACCESS DENIED: UNAUTHORIZED PERSONNEL.\n\nYour credentials are not in the database.");
            document.getElementById('userName').value = ""; 
        }
    }

    function moduleLocked() {
        alert("ACCESS DENIED // MODULE LOCKED");
    }

    function startTimer() {
        const timerDisplay = document.getElementById('timer-text');
        
        clearInterval(timerInterval); // Reset any existing timer
        timeRemaining = EXAM_DURATION; 

        // Initial Display
        updateTimerDisplay();

        timerInterval = setInterval(() => {
            timeRemaining--;
            updateTimerDisplay();

            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                alert("TIME LIMIT REACHED. SUBMITTING DATA.");
                showResults();
            }
        }, 1000);
    }

    function updateTimerDisplay() {
        const timerDisplay = document.getElementById('timer-text');
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        timerDisplay.innerText = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        // Visual warning when time is low (optional)
        if (timeRemaining < 300) { // Less than 5 mins
            timerDisplay.style.color = "#ff0000";
            timerDisplay.style.textShadow = "0 0 10px #ff0000";
        }
    }

    function startExam(subject) {
        selectedSubject = subject;
        currentIdx = 0;
        score = 0;
        
        const originalQuestions = database[selectedSubject] || [];
        shuffledQuestions = shuffleArray([...originalQuestions]); 
        
        if(shuffledQuestions.length === 0) return alert("MODULE OFFLINE");

        document.getElementById('live-score').innerText = score;
        document.getElementById('current-subject').innerText = subject.toUpperCase();
        
        showScreen('exam-screen');
        startTimer(); // START THE CLOCK
        loadQuestion();
    }

    function loadQuestion() {
        selectedAnswer = null;
        showingSolution = false;
        
        document.getElementById('solution-container').style.display = 'none';
        document.getElementById('action-btn').innerText = "COMMIT ANSWER";
        
        const q = shuffledQuestions[currentIdx];

        document.getElementById('progress-text').innerText = `${currentIdx + 1} / ${shuffledQuestions.length}`;
        document.getElementById("question-text").innerText = q.q;
        const container = document.getElementById("options-container");
        container.innerHTML = "";
        
        const shuffledOptions = shuffleArray([...q.a]);
        
        shuffledOptions.forEach(option => {
            const div = document.createElement("div");
            div.innerText = option;
            div.className = "option";
            div.onclick = () => {
                if (showingSolution) return;
                document.querySelectorAll('.option').forEach(el => el.classList.remove('selected'));
                div.classList.add('selected');
                selectedAnswer = option;
            };
            container.appendChild(div);
        });
    }

    function handleAction() {
        if (!selectedAnswer) return alert("SELECT AN ANSWER");
        
        const q = shuffledQuestions[currentIdx];

        if (!showingSolution) {
            // CHECK ANSWER PHASE
            showingSolution = true;
            if (selectedAnswer === q.c) {
                score++;
                // Update Live Score Immediately
                document.getElementById('live-score').innerText = score;
                document.querySelectorAll('.option').forEach(el => {
                    if (el.innerText === selectedAnswer) el.classList.add('correct');
                });
            } else {
                document.querySelectorAll('.option').forEach(el => {
                    if (el.innerText === selectedAnswer) el.classList.add('wrong');
                    if (el.innerText === q.c) el.classList.add('correct');
                });
            }
            
            // Reveal Solution
            document.getElementById('solution-text').innerText = q.showSolution;
            document.getElementById('calc-technique').innerText = q.calculatorTechnique;
            document.getElementById('solution-container').style.display = 'block';
            document.getElementById('action-btn').innerText = "NEXT QUESTION";
        } else {
            // NEXT PHASE
            currentIdx++;
            if (currentIdx < shuffledQuestions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }
    }

    function showResults() {
        clearInterval(timerInterval); // Stop timer
        showScreen('result-screen');
        const total = shuffledQuestions.length;
        const percent = (score / total) * 100;
        
        const passed = percent >= 70;
        document.getElementById('final-status').innerText = passed ? "LICENSE SECURED" : "RE-TRAINING REQUIRED";
        document.getElementById('final-status').style.color = passed ? "var(--correct)" : "var(--wrong)";
        
        document.getElementById('score-text').innerText = `ENGINEER ${userName}, RATING: ${percent.toFixed(1)}%`;
    }
</script>
</body>
</html>